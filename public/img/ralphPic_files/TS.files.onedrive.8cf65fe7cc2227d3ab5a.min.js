webpackJsonp([475],{3940:function(e,n){!function(){"use strict";TS.registerModule("files.onedrive",{onStart:function(){TS.client&&TS.files.team_file_shared_sig.add(c)},openPickerWindow:function(){var l=null;return new Promise(function(o,i){TS.utility.window.open({url:e,try_window_open_in_ssb:!0,height:n,width:t})||i(new Error("could not open window")),l=a(o,i),window.addEventListener("message",l),r&&i("Promise already made"),r=!0}).then(function(e){return r=!1,s(e.chosen_files,TS.shared.getActiveModelOb())}).catch(function(e){if("Promise already made"!==e){var n=o;TS.error(e),"unidentified_external_url"!==e.data.error&&"file_type_has_no_handler"!==e.data.error||!e.args.link||(n=TS.i18n.t("We don’t currently support importing that type of OneDrive file, but we included the link so that others can access it.","files")()),"filename_too_long"===e.data.error&&(n=i),TS.client.ui.addEphemeralBotMsg({text:n,ephemeral_type:"file_type_has_no_handler",slackbot_feels:"sad_surprise"}),r=!1}}).finally(function(){window.removeEventListener("message",l)})}});var e=TS.boot_data.team_url+"files/import/onedrive",n=1,t=1,r=!1,o=TS.i18n.t("Darn, that didn’t work. Try again or <https://my.slack.com/help/requests/new|contact us> if it’s still not working.","files")(),i=TS.i18n.t("Sorry! The name of that file is too long for us to handle. Please try importing a file with a shorter filename.","files")(),a=function(e,n){return l({resolve:e,reject:n,method:"onedrive_picker"})},l=function(e){return function(n){n.data.method===e.method&&(n.data.ok?e.resolve(n.data):e.reject(new Error(e.method+" not ok")))}},s=function(e,n){var t=e.map(function(e){return d(e,n)});return Promise.all(t)},d=function(e,n){return TS.api.call("files.uploadExternal",{channels:n.id,link:e}).then(function(e){TS.log(9999,"TODO"),TS.log(9999,e)})},c=function(e){"onedrive"===_.get(e,"external_type")&&_.get(e,"user")===TS.model.user.id&&TS.model.team.prefs.onedrive_enabled_team&&(TS.model.prefs.seen_onedrive_coachmark||(TS.coachmark.start(TS.coachmarks.coachmarks.onedrive),TS.model.prefs.seen_onedrive_coachmark=!0,TS.prefs.setPrefByAPI({name:"seen_onedrive_coachmark",value:!0})))}}()}},[3940]);